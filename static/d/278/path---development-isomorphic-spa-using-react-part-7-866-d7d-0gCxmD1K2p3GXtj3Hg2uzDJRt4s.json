{"data":{"site":{"siteMetadata":{"title":"pjb0811.github.io","author":"Jeongbin Park","description":"프론트엔드 웹 개발 기술 블로그","siteUrl":"https://pjb0811.github.io"}},"markdownRemark":{"id":"5d9dc0a9-45b8-58f7-a740-5317977ed454","excerpt":"…","html":"<blockquote>\n<p>이번 파트는 페이지의 <code class=\"language-text\">head</code> 설정을 도와주는 라이브러리인 <code class=\"language-text\">react-helmet</code> 를 활용한 내용을 정리했다. 이번 글 역시 스스로의 학습 내용을 정리하는 글이기 때문에 편한 말투로 작성했다.</p>\n</blockquote>\n<p>우선 맨 처음 글을 작성할 때로 돌아가 보자. 클라이언트 기반의 <code class=\"language-text\">SPA</code>의 경우 <strong>검색엔진 최적화(SEO)</strong>에 필요한 정적 렌더링 정보을 제공하지 않기 때문에(굳이 <code class=\"language-text\">SEO</code>만을 위한건 아니지만) 클라이언트 렌더링 뿐만 아니라 서버 렌더링 정보를 제공하는 <code class=\"language-text\">Isomorphic SPA</code>를 개발했다. 그 과정에서 라우팅, 코드 스플리팅, 비동기 데이터 및 <code class=\"language-text\">redux</code>, <code class=\"language-text\">mobx</code>를 활용한 전역 상태 데이터 처리에 대한 서버 측 렌더링 작업을 진행해왔다.</p>\n<p>하지만 무엇보다 웹페이지가 검색엔진에 노출되기 위해서는 <strong>타이틀 태그와 메타디스크립션 태그</strong> 를 갖고 있어야 한다. 사실 <code class=\"language-text\">SEO</code>에 필요한 내용이 비단 정적 렌더링을 통한 페이지 정보뿐만 아니라 <code class=\"language-text\">보안 프로토콜(HTTPS)</code>, <code class=\"language-text\">Robots.txt</code>, <code class=\"language-text\">sitemap.xml</code> 설정 및 이외에도 필요한 설정들이 여러가지 있지만 위 방식을 설정하는 방법들은 잘 모르기 때문에 따로 정리하진 않았다.</p>\n<p>우선 일반적인 클라이언트 기반의 <code class=\"language-text\">SPA</code> 의 경우 라우팅 영역의 페이지 접근 시 <code class=\"language-text\">body</code> 태그 내부에 선언된 특정 요소를 렌더링해준다. 지금까지 구현한 앱의 경우에도 페이지 요청 시 <code class=\"language-text\">&lt;div id=&quot;root&quot;/&gt;</code> 요소 내부의 컨텐츠를 각 라우팅 영역에 맞게 렌더링해주고 있다. 하지만 이런 경우 <code class=\"language-text\">head</code> 요소를 포함한 정적인 영역에 대해서는 각 페이지에 필요한 요소를 그려주지 못하게 된다.</p>\n<p>이런 경우 직접 <code class=\"language-text\">DOM</code> 구조에 접근하여 필요한 요소를 만들어주면 되지만 <code class=\"language-text\">head</code> 태그에 필요한 요소를 필요한 컴포넌트에서 만들어 줄 수 있는 <code class=\"language-text\">react-helmet</code>이라는 라이브러리를 사용했다. 이제 해당 라이브러리를 사용한 내용을 정리해보자.</p>\n<h2>react-helmet</h2>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/react-helmet-899ddd56490267d068a210888c6526e5-c1266.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 66.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAUGAgT/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAv/aAAwDAQACEAMQAAABWP5ynT2GxX//xAAbEAACAwADAAAAAAAAAAAAAAACBAABAxESIf/aAAgBAQABBQKh5pfSs1RLuMT9Vn//xAAVEQEBAAAAAAAAAAAAAAAAAAAQIf/aAAgBAwEBPwGn/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRAAAgMBAAAAAAAAAAAAAAAAAAIBEBFB/9oACAEBAAY/AhNIaO0tf//EABkQAQEBAQEBAAAAAAAAAAAAAAEAMRGxIf/aAAgBAQABPyH73Ziz19ixEFMYAUHfYAy//9oADAMBAAIAAwAAABA/D//EABYRAQEBAAAAAAAAAAAAAAAAAAEREP/aAAgBAwEBPxAKa5//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPxBSf//EABoQAQADAQEBAAAAAAAAAAAAAAEAEUEhMWH/2gAIAQEAAT8QdeVZC/bDZnUvhqsH2CIgMO0YS9QCgB8n/9k='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"react-helmet\"\n        title=\"\"\n        src=\"/static/react-helmet-899ddd56490267d068a210888c6526e5-f8fb9.jpg\"\n        srcset=\"/static/react-helmet-899ddd56490267d068a210888c6526e5-e8976.jpg 148w,\n/static/react-helmet-899ddd56490267d068a210888c6526e5-63df2.jpg 295w,\n/static/react-helmet-899ddd56490267d068a210888c6526e5-f8fb9.jpg 590w,\n/static/react-helmet-899ddd56490267d068a210888c6526e5-85e3d.jpg 885w,\n/static/react-helmet-899ddd56490267d068a210888c6526e5-d1924.jpg 1180w,\n/static/react-helmet-899ddd56490267d068a210888c6526e5-c1266.jpg 1200w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>앞서 설명한대로 <code class=\"language-text\">react-helmet</code>을 통해 컴포넌트 영역에서 현재 페이지에 필요한 <code class=\"language-text\">head</code> 관련 요소를 설정해 줄 수 있다. <code class=\"language-text\">SEO</code>에 필요한 <code class=\"language-text\">title</code>, <code class=\"language-text\">meta</code> 요소뿐만 아니라 <code class=\"language-text\">link</code>, <code class=\"language-text\">script</code>, <code class=\"language-text\">style</code> 등 <code class=\"language-text\">head</code> 에 포함할 수 있는 태그들을 동적으로 설정할 수 있으며 서버 렌더링도 지원한다.</p>\n<p>그럼 라이브러리를 사용하기 전 우선 지금까지 구현했던 앱의 <code class=\"language-text\">head</code> 정보를 살펴보자.</p>\n<p><img src=\"/head-info-13d382237596fa4c58845bb5fbccb1ea.gif\" alt=\"head-info\"></p>\n<p>페이지를 이동하더라도 각 페이지별로 <code class=\"language-text\">head</code> 영역에 대한 설정은 해주지 않았기 때문에 라우팅 이동 시 동적으로 추가되는 <code class=\"language-text\">script</code> 를 제외한 <code class=\"language-text\">title</code>, <code class=\"language-text\">meta</code> 등의 요소에 대한 변경은 이루어지지 않는다.</p>\n<p>그럼 이제 <code class=\"language-text\">react-helmet</code>를 사용하여 클라이언트 및 서버 렌더링을 작업을 진행해보자.</p>\n<h3>Client</h3>\n<p>우선 라이브러리를 설치한 뒤 기본 베이스로 사용되는 <code class=\"language-text\">pubilc/index.html</code> 의 <code class=\"language-text\">head</code> 요소를 수정해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">yarn add --dev react-helmet</code></pre></div>\n<ul>\n<li><code class=\"language-text\">public/index.html</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\">&lt;!DOCTYPE html></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>shortcut icon<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>%PUBLIC_URL%/favicon.ico<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span>\n      <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>width=device-width, initial-scale=1, shrink-to-fit=no<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>theme-color<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>#000000<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>manifest<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>%PUBLIC_URL%/manifest.json<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>noscript</span><span class=\"token punctuation\">></span></span> You need to enable JavaScript to run this app. <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>noscript</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>root<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>우선 기존에 있던 <code class=\"language-text\">title</code> 요소 및 주석들을 제거해주었다. 이 후 컴포넌트에서 각 페이지의 대한 타이틀을 포함한 <code class=\"language-text\">head</code> 요소를 추가하도록 하자.</p>\n<p>그럼 우선 전체 페이지에 영역에서 공통으로 사용하게 될 <code class=\"language-text\">head</code> 정보를 설정하기 위해 <code class=\"language-text\">App</code> 컴포넌트를 수정해보자.</p>\n<ul>\n<li><code class=\"language-text\">src/App.js</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// ...</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Helmet <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-helmet'</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">App</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Helmet<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>title<span class=\"token operator\">></span>My App<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>title<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>meta name<span class=\"token operator\">=</span><span class=\"token string\">\"description\"</span> content<span class=\"token operator\">=</span><span class=\"token string\">\"my app\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>style<span class=\"token operator\">></span>\n            <span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token string\">`body {\n              background-color: green \n            }`</span></span><span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>style<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Helmet<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Switch<span class=\"token operator\">></span>\n          <span class=\"token punctuation\">{</span>routes<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>route<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n            <span class=\"token operator\">&lt;</span>Route key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>i<span class=\"token punctuation\">}</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>route<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n          <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Switch<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>사용법은 어렵지 않다. <code class=\"language-text\">react-helmet</code>에서 제공하는 <code class=\"language-text\">Helmet</code> 컴포넌트의 자식 요소에 사용하고자 하는 태그를 설정해준 뒤 렌더링해주면 된다.</p>\n<p>해당 컴포넌트의 경우 모든 라우팅 컴포넌트에 대한 최상위의 부모 컨포넌트이기 때문에 각 라우팅 컴포넌트는 <code class=\"language-text\">App</code> 에서 설정한 <code class=\"language-text\">head</code> 정보를 사용하게 된다.</p>\n<p><code class=\"language-text\">Helmet</code> 컴포넌트의 설정된 <code class=\"language-text\">head</code> 정보는 <code class=\"language-text\">cascade</code> 방식으로 적용되기 때문에 각 라우팅 컴포넌트 별로 필요한 <code class=\"language-text\">head</code> 정보를 설정해주면 된다.</p>\n<ul>\n<li><code class=\"language-text\">src/components/About.jsx</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// ...</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Helmet <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-helmet'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">About</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Helmet<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>title<span class=\"token operator\">></span>About<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>title<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>meta name<span class=\"token operator\">=</span><span class=\"token string\">\"description\"</span> content<span class=\"token operator\">=</span><span class=\"token string\">\"about\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>style<span class=\"token operator\">></span>\n          <span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token string\">`body {\n              font-size: 20px;\n            }`</span></span><span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>style<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Helmet<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span>About<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Counter <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// ...</span></code></pre></div>\n<p><code class=\"language-text\">About</code> 컴포넌트의 경우 <code class=\"language-text\">head</code> 정보를 새롭게 설정해주었다. <code class=\"language-text\">App</code> 에서 설정한 <code class=\"language-text\">title</code>, <code class=\"language-text\">meta</code> 요소 변경 및 새로운 <code class=\"language-text\">style</code> 요소를 추가해 주었다. 그럼 이제 실행화면을 확인해보자.</p>\n<p><img src=\"/head-after-5a6742da81d68ff1e2fc6200925c5d9a.gif\" alt=\"head-after\"></p>\n<p><code class=\"language-text\">About</code> 컴포넌트를 제외한 나머지 라우팅 컴포넌트에서는 <code class=\"language-text\">App</code> 에서 설정한 <code class=\"language-text\">head</code> 정보를 사용하는 것을 확인했다.</p>\n<p>또한 부모 컴포넌트로부터 상속받은 <code class=\"language-text\">head</code> 정보에서 중복되지 않아야 할 요소는 기존 요소의 컨텐츠가 변경되며 중복 가능한 요소는 새롭게 추가되는 것을 확인했다.</p>\n<p>그럼 이제 서버 측 영역에서 <code class=\"language-text\">head</code> 정보를 렌더링하도록 해보자.</p>\n<h3>Server</h3>\n<p>서버 측 렌더링 설정도 크게 어렵지 않다. 기존에 서버 렌더링 정보를 반환하는 <code class=\"language-text\">renderer</code> 함수 호출 시 <code class=\"language-text\">head</code> 요소에 대한 정적 데이터 정보를 추가해주면 된다.</p>\n<ul>\n<li><code class=\"language-text\">src/lib/renderer.js</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// ...</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Helmet <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-helmet'</span>\n\n<span class=\"token keyword\">const</span> renderer <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> req<span class=\"token punctuation\">,</span> html <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n\n  <span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">renderToString</span><span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>Loadable<span class=\"token punctuation\">.</span>Capture report<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>moduleName <span class=\"token operator\">=></span> modules<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>moduleName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>StaticRouter location<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>req<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">}</span> context<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>context<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Provider <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>store<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>App <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Provider<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>StaticRouter<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Loadable<span class=\"token punctuation\">.</span>Capture<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> helmet <span class=\"token operator\">=</span> Helmet<span class=\"token punctuation\">.</span><span class=\"token function\">renderStatic</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> bundles <span class=\"token operator\">=</span> <span class=\"token function\">getBundles</span><span class=\"token punctuation\">(</span>stats<span class=\"token punctuation\">,</span> modules<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> renderHTML <span class=\"token operator\">=</span> html\n    <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span>\n      <span class=\"token string\">'&lt;/head>'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>helmet<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\n      </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>helmet<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\n      </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>helmet<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\n      &lt;/head>`</span></span>\n    <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span>\n      <span class=\"token string\">'&lt;div id=\"root\">&lt;/div>'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token template-string\"><span class=\"token string\">`&lt;div id=\"root\"></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>app<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/div>\n    &lt;script>window.__INIT_DATA__ = </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token function\">toJS</span><span class=\"token punctuation\">(</span>store<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/script>\n    </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>bundles\n      <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>bundle <span class=\"token operator\">=></span> <span class=\"token operator\">!</span>bundle<span class=\"token punctuation\">.</span>file<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.map'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>bundle <span class=\"token operator\">=></span> `<span class=\"token operator\">&lt;</span>script src<span class=\"token operator\">=</span>\"$<span class=\"token punctuation\">{</span>bundle<span class=\"token punctuation\">.</span>publicPath<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\">&lt;/script>`</span></span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n    `\n    <span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    html<span class=\"token punctuation\">:</span> renderHTML<span class=\"token punctuation\">,</span>\n    context<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> renderer</code></pre></div>\n<p><code class=\"language-text\">renderToString</code> 함수 호출 이 후 <code class=\"language-text\">react-helmet</code> 에서 제공하는 <code class=\"language-text\">renderStatic</code> 함수를 호출하여 <code class=\"language-text\">App</code> 컴포넌트에 설정된 <code class=\"language-text\">head</code> 정보의 데이터를 가져왔다. 이 후 렌더링된 문자열 반환 시 <code class=\"language-text\">head</code> 요소 내부에 가져온 요소를 추가한 문자열을 반환하도록 수정했다.</p>\n<p>현재는 <code class=\"language-text\">title</code>, <code class=\"language-text\">meta</code>, <code class=\"language-text\">script</code> 요소에 대한 문자열을 설정했지만 이 후 필요한 요소가 있을 경우 그에 맞는 데이터를 추가해주면 된다.</p>\n<p>그럼 이제 서버 측 수정도 완료되었으니 결과를 확인해보자.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/head-server-home-1c7687cb924083423e5bead572a0fdd6-3a8a9.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 57.58323057953144%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABJ0AAASdAHeZh94AAABqklEQVQoz41S227qQAzM/39dX3pUgVQKDSHJspu9X5PMMUlpS+EBSyPL1njkW/Xy+ob9Z4P6xNB0DMf2ih4v/94wSEWQ4GLAmfMlDiHiLCR2h+YXf0XVnwWRDAQR256j5xIdEzh1Z2zfdxiUgScBHxKcD+QDYsowzoPxgeo0ONVeUc1jwpgNLBEGKaAVg1RE5M3SlVYdnHMIXizCF7EQ0+JzKUg536AyVBwdA6dOg7eYikFOAXPRy2hzURRHlDggU8E8zz+YpjtUbvCI2iL6RAl824x7u+RuBB+gSi7BNBrJKTiloWREcBnTWKijCTECKYHiCc9YVXKBqiVsX6OtFfYHD8ktHDugrwU224DPQ6CdRjibYQnGrH5FWeKSxrXDcrlYq2FZS4J0XerWCgZ2FHjfSmw2moQdxlS+Rv4Ze7r66dfIOWboI4l0NXW5J7+DOX2gbyM4/ZWgV+K9h5YJOTgkI2F0orWU5Qh3I0/jCM44WNfC0Ns4LRdY42lv8xMHuc1XmUa2wsDQA1/eJFEc6Qo5p1Xoi7hUPrI/+SrRuwTh6YyPuPONf8b+A4Mzo+y44acZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"head-server-home\"\n        title=\"\"\n        src=\"/static/head-server-home-1c7687cb924083423e5bead572a0fdd6-fb8a0.png\"\n        srcset=\"/static/head-server-home-1c7687cb924083423e5bead572a0fdd6-1a291.png 148w,\n/static/head-server-home-1c7687cb924083423e5bead572a0fdd6-2bc4a.png 295w,\n/static/head-server-home-1c7687cb924083423e5bead572a0fdd6-fb8a0.png 590w,\n/static/head-server-home-1c7687cb924083423e5bead572a0fdd6-3a8a9.png 811w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/head-server-about-a409933349114026f555ba6776ea5d83-6f6cd.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 69.29936305732484%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABJ0AAASdAHeZh94AAACBklEQVQ4y41T247TMBTM/38VD7yABBISAu0uLW1p7nEc27GT2EmGqVmy7S4sWBo5cU7Hc2ZOkzfvP+Htuw+4352wO2bYP2J3SHH8kePj56+o6wZdp9A0AjVRVQ2UNmjaDl/u9lv9Bckxq1GUNYTUqIXEOSuRlQJpUfO5wrfvB5K0kJ2GNg7WOfS9hRsGGOtQ1CL+rnpE4scJWDyW2cBai051sKaG1gpK5hCthNEVpGxh+zoSTT5gnDx3jxBm+BA2JJVoYLoOA4tb0WKggiUYeD/GfZomrKFH4PvsFc891nXdsCzLDZKcflhpMWrCkWTGtla8XJeza8LnSC4eTCQyOdX0GgNb7eQIZ2kDWwh+oUpELPP6l2ueVlToWa0zDVOcUaUtDkcHKRhAfUKbt3h4GHA8DRA1gzATvQ7cPcO5Bj0cwhNhX/boq5yETPhMcnorsgb7e4X7O4X8ZDGPF/8QsSzrC8SWM47MNI7oi54qzyQ9kPxAC/aococmF2hZ01ZUpyZMg6M1XXweXCDzrQVJWlSY54COQ1qkKQtlhDWKbdl48xbGPwKJCtO8ovEernPQQvFWpk0VI3dnh62Vrdc/pH59Hglnpqka/rWynPPIwdYS3hkS0+jp1xy9pur390h4zsuo0HIOlaRC+ukclV3duq6vj8qth2WFka1Zprz4+badZwr+h/gnlas8fKfur6sAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"head-server-about\"\n        title=\"\"\n        src=\"/static/head-server-about-a409933349114026f555ba6776ea5d83-fb8a0.png\"\n        srcset=\"/static/head-server-about-a409933349114026f555ba6776ea5d83-1a291.png 148w,\n/static/head-server-about-a409933349114026f555ba6776ea5d83-2bc4a.png 295w,\n/static/head-server-about-a409933349114026f555ba6776ea5d83-fb8a0.png 590w,\n/static/head-server-about-a409933349114026f555ba6776ea5d83-6f6cd.png 785w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p><code class=\"language-text\">App</code> 컴포넌트에서 설정한 기본 <code class=\"language-text\">head</code> 요소 및 <code class=\"language-text\">About</code> 컴포넌트에서 설정한 <code class=\"language-text\">head</code> 요소에 대한 서버 렌더링이 정상적으로 동작하는 것을 확인할 수 있다.</p>\n<h2>글을 마치며</h2>\n<p>지금까지 React를 활용한 <code class=\"language-text\">Isomorphic SPA</code> 개발에 필요한 내용들을 정리해봤다.</p>\n<p>사실 내 나름대로 구현한 내용을 정리한 내용이라 부족한 부분도 있으며, 인터넷 여기저기서 검색한 내용들을 정리하기도 해서 조금 아쉬운 부분도 있다.</p>\n<p>그래도 글을 정리하면서 실제 개발만 했던 것보다 머리속에 좀 더 정리가 되었던 것 같다. 앞으로도 이 전에 해왔던 개발경험 뿐만 아니라 이 후 개발하면서 배웠던 내용들을 꾸준히 정리할 수 있었으면 한다.</p>","frontmatter":{"title":"React를 활용한 isomorphic SPA 개발하기 - 7부","date":"2019.02.14","tags":["react"],"translation":null,"mainImage":{"childImageSharp":{"sizes":{"aspectRatio":1.5037593984962405,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAUGAgT/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAv/aAAwDAQACEAMQAAABWP5ynT2GxX//xAAbEAACAwADAAAAAAAAAAAAAAACBAABAxESIf/aAAgBAQABBQKh5pfSs1RLuMT9Vn//xAAVEQEBAAAAAAAAAAAAAAAAAAAQIf/aAAgBAwEBPwGn/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRAAAgMBAAAAAAAAAAAAAAAAAAIBEBFB/9oACAEBAAY/AhNIaO0tf//EABkQAQEBAQEBAAAAAAAAAAAAAAEAMRGxIf/aAAgBAQABPyH73Ziz19ixEFMYAUHfYAy//9oADAMBAAIAAwAAABA/D//EABYRAQEBAAAAAAAAAAAAAAAAAAEREP/aAAgBAwEBPxAKa5//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPxBSf//EABoQAQADAQEBAAAAAAAAAAAAAAEAEUEhMWH/2gAIAQEAAT8QdeVZC/bDZnUvhqsH2CIgMO0YS9QCgB8n/9k=","sizes":"(max-width: 1200px) 100vw, 1200px","src":"/static/react-helmet-899ddd56490267d068a210888c6526e5-9fbf0.jpg","srcSet":"/static/react-helmet-899ddd56490267d068a210888c6526e5-b95c3.jpg 300w,\n/static/react-helmet-899ddd56490267d068a210888c6526e5-9ff9f.jpg 600w,\n/static/react-helmet-899ddd56490267d068a210888c6526e5-9fbf0.jpg 1200w"}}}}}},"pageContext":{"slug":"/development-isomorphic-spa-using-react-part7/","previous":{"id":"178bfd83-6d66-57ea-91f0-82e169bd07a1","excerpt":"\r\n> 이번 파트는 전역 상태 관리 라이브러리인 `mobx` 를 활용한 내용을 정리했다. SPA 환경에서 전역 상태로 관리되는 데이터를 서버와 클라이언트 영역에서 어떻게 처리했는지에 대한 내용을 정리했다. ","frontmatter":{"title":"React를 활용한 isomorphic SPA 개발하기 - 6부","date":"2019.02.12","tags":["react"],"translation":null,"mainImage":{"childImageSharp":{"sizes":{"aspectRatio":1,"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAE50lEQVQ4y1WVXWxTZRjHj2MSoqxde04/TrsRE6MGTLgw8cLECxODJgYIgqxdv9t16zbokVSjaAyBxBtQQC8YyI0xQuSC+A0iYgwX3hkThX31+4t27fqxua3dfPX9+7wtXHjxT5tzTn7neZ/n//yPNO029MwPK45ZpxKbdshRkjbtMGp3Dhq02WGDlvAatLi7X5snzbn0dE2nzTh12rSzj57bqt0d2hr98+AjseKIxYHTz/dI8y7FUQuZUfGbseA3oSzkU1DyynRNRmNURn3EiNqIAYshA6rBflQCeiwI+XUoerd2nkFsG6rjdoc05zLFKkEzUm6lnXSZWKIjhcWHZZKR5fxdZX0GlvH2s7RHz1Id9dP9PpYPGNny4cE2OzKI8pgtJoDRatBCQBNLuhSeGNLz+JCOx51GksyzXiPP+42cgDzjNfC0t5+n3DqecGzhOU8fXzo0wJuTA+xvbQClUTVKRzZpiyECekyMoDw7+TTS49uR8FpBUKQ9MqgKUJUgKKhKpP0KCtGnsPTOMyAYr0/Y2IZmx72wVSOgWauFrEi7FZb223jz2hRYrYjqp29jbu8mpHxWAsodYE68eL+E2mdvgjfuoX3rE9QPP8ZrEStbj9pBg9Gk+AOg10xAlc/vlrB0/TzqX53GzEsS6PgEVDrQrKcP2b0SWtc/wvrPF1Fzb0bt0Da+GFFZ+7CKfEgA3V1gpgO08TgBm9fOoXblfaTCjyN/7GUC9SPv06N8/EU039iB9rcn0frpAhZdvVicHOTVMStrHbIiFzR3gfURAbSwjADuoQp/uIDapWMovLcL6/kZaocRRQJupH/HyqndWLt6Aq1bF1EZ7kV1YoBXRi1sbdKKbNBEQE8XmL0PTAgg9bF+9STi+zZjo5RE4a3n0Hj3WfxbjqMW6EPruw/RunkBC85NqIzb+ULYwlYmLMgEFE1KeCxaPSyAZpb12+8Dz6Hx9RnMvkD/f7mMpSvHsXLpKNZ//QLVfaKHH2Pt5nmUHT1YiNh5acTM/ho30/RlTUoSsBFWyRIWlg3YeXLvQzSUKTRoKHO7JJRPvIKNzB9YT/6G5VN7UDkgYe3aWaz9OIXSUI8wM78XMrHliIkc0QFa/w98UOGXHyD9ai/y1L/WndvYmLlNq2dExbUZq3Tk1RvnUDwoCTPzYlBhS2MKkl5jF9gM28hnBAzaeUpUSENZ/uYssvsfRt6vojD+JAoTT6AaUVF29mL1+zNYpR4WXpNQDFt5ISCzJu1zwmMgoJeAowT0mVkuNMiXyYPC2M3P30X2wBby1gDZRkHGLaMcGUCZKly+fBT/1ApYuTFFQJVW08DqYRkikQiodoB5n5VCwMqL2k6UXt9JoG30EotoRUdprwUFCpGFsBmlMRvKR7ajdGSHMDzPUXDUKJFEvEkprxptjtrpyCrLEzDvUXjOTfJZKBAsFAjmjmjX6dckJko9k3nBq+uEA8FEcLBqqB+zw/qolPapMQEsBNR2IWCjOCIRnKplwkqdDeoGB0lhYgBCeVLOLz+ItXaFcpKCNyZl/apjJWLH0pgdAtygAYmpC7OLlRRJVAl0A7jsM9E9BWKijXA3eEXoCthiUI9ZZ59DygasPQJKR4/RxKPC6GIdRQpRVlLkKxp9HrQZ+jTcHTLSdaMm7BGnid7/LERnhnUxAbtz4NGe/wC90a5o8GBdIgAAAABJRU5ErkJggg==","sizes":"(max-width: 400px) 100vw, 400px","src":"/static/mobx-5873c91986410a6886012fb838f99d31-bd007.png","srcSet":"/static/mobx-5873c91986410a6886012fb838f99d31-c6fef.png 200w,\n/static/mobx-5873c91986410a6886012fb838f99d31-bd007.png 400w"}}}},"fields":{"slug":"/development-isomorphic-spa-using-react-part6/"}},"next":null}}