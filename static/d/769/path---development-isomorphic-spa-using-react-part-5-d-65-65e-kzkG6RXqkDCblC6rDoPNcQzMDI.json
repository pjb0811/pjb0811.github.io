{"data":{"site":{"siteMetadata":{"title":"pjb0811.github.io","author":"Jeongbin Park"}},"markdownRemark":{"id":"fef11fcf-2c16-5929-ab16-9995cd4ffcd2","excerpt":"이번 파트는 전역 상태 관리 라이브러리인  와   를 활용한 내용을 정리했다. SPA…","html":"<blockquote>\n<p>이번 파트는 전역 상태 관리 라이브러리인 <code class=\"language-text\">redux</code>와 <code class=\"language-text\">mobx</code> 를 활용한 내용을 정리했다. SPA 환경에서 전역 상태로 관리되는 데이터를 서버와 클라이언트 영역에서 어떻게 처리했는지에 대한 내용을 정리했다. 이번 글 역시 스스로의 학습 내용을 정리하는 글이기 때문에 편한 말투로 작성했다.</p>\n</blockquote>\n<h2>redux &#x26; mobx</h2>\n<p><code class=\"language-text\">redux</code> 와 <code class=\"language-text\">mobx</code>는 JavaScript 개발 환경에서 대표적으로 사용되는 상태 관리 라이브러리이다. 말 그대로 JavaScript 환경에서는 어디든지 사용할 수 있기 때문에 VanillaJS 환경뿐만 아니라 특정 프레임워크 및 라이브러리로 구성된 프로젝트에 상관없이 사용 가능하다.</p>\n<p>그래서 react 뿐만 아니라 vue.js, angular 등의 환경에서도 사용 가능한 걸로 알고 있는데, 이번 글에는 <code class=\"language-text\">redux</code>와 <code class=\"language-text\">mobx</code>의 간략한 개념정리 및 react 환경에서 <code class=\"language-text\">redux</code>와 <code class=\"language-text\">mobx</code>를 어떻게 활용했는지에 대한 내용만 정리하려 한다. 나 또한 <code class=\"language-text\">redux</code>와 <code class=\"language-text\">mobx</code>를 완벽히 다룬다고 생각하지 않으며 react 이외에 환경에서는 사용해보지 않아 설명할 내용도 없긴 하지만 나중에 공부해 보도록 하자</p>\n<p>우선 react의 경우 컴포넌트 간 데이터 전달 시 부모로부터 자식 요소의 단방향 데이터 흐름을 강제한다. 이러한 구조는 순차적인 흐름으로써 사람이 갖고 있는 자연스러운 사고방식이기 때문에 데이터의 흐름을 쉽게 파악할 수 있고 관리하기도 편하다고 생각한다. 최근에는 <code class=\"language-text\">Context API</code>라는 기능을 통해 기본적인 데이터 흐름을 벗어나 전역 상태를 관리할 수 있지만 내가 아직 많이 사용해보지 않았기 때문에 이 번 글에서는 따로 설명하지 않겠다.</p>\n<p>아무튼 이러한 단방향 데이터 흐름의 경우 앱의 규모가 커지고 컴포넌트의 양이 늘어날 경우, 컴포넌트에서 사용하지 않는 데이터를 전달받는다든가 아니면 전역 데이터를 특정 부모 컴포넌트에 의존해야만 하는 경우도 생기게 된다. 결국 불필요하게 전달받는 데이터가 많아지면 데이터 구조가 복잡해지며 결국 컴포넌트의 상태를 관리하기가 힘들어지게 된다.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cd35d8dce7d99b99eb79384be259eee0/adc74/data-flow.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 500px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 63%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAACAUlEQVQoz3VS226bQBDln/vY32neU/XJTVXZspNw2cXcDQaW2MbcW7vFxtwWOgYljaV2BCMY7Zk5O+cwfd9XVYUx1jTNtm2EkGEY/Wt0lEIOgkBRVV3X54tFmqbXetdBZuCllEZRlCTJ8Xj0fR8++tsoivOv4yHNfoRBUJaXtzrz/tDY7y3apjrE5iEQz+fDLqfr7LL73Va0vwGPCEdRgVVd1wPbFvLPvTi//zi5+7C1ZyQrHiaT1Sba5l1L6c3kxCWKKMqaSohL62ak0FSnaIu39oMfOlNxzQlYlBUvy0/D9G4EV2mGeU6Rpa1psSy7M1Z9UQ50umPVXzqqrRASBJUEGAmysYbicMeeKU8nC2HLJSHxxO/TpaYqGEcOGXd9rmqd7JE4D8O9ZHkcLyBJMdzNsJ+OieP48ekpy9IyzeaLR0fVeJa1bLsfmMNu2WdW1njQRFVkUMvQNSTw42oYUDiKo+mXmad7RVkYmoYRWi6XHvHyPJckyfd3iBWfp0Ld1JvNRkBIkmXwQlmWDMdxUP18903ir95ACOuGYZqmoihhGM5ms+Jy4ufy/aevV0Uch+d5z/MABa2ZpmleFe5Gw0DALx30aNu2/3+8N8lfhwAcsmu9EOcF5lim5TgumM91XX/nE0KgCH2Zf7YcdY7D5PokMZgX9ppl2ehiuA64Haj9AWbnyShCgy36AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"data-flow\"\n        title=\"\"\n        src=\"/static/cd35d8dce7d99b99eb79384be259eee0/adc74/data-flow.jpg\"\n        srcset=\"/static/cd35d8dce7d99b99eb79384be259eee0/e40b4/data-flow.jpg 148w,\n/static/cd35d8dce7d99b99eb79384be259eee0/ead33/data-flow.jpg 295w,\n/static/cd35d8dce7d99b99eb79384be259eee0/adc74/data-flow.jpg 500w\"\n        sizes=\"(max-width: 500px) 100vw, 500px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>이렇게 단향방 데이터의 흐름에서 벌어질 수 있는 단점을 보완하기 위해 위와 같이 상태 관리 라이브러리를 활용하여 컴포넌트의 종속되지 않고 데이터를 관리해 준다고 보면 될 것 같다(위 사진에는 <code class=\"language-text\">redux</code>만 설명되어 있지만 <code class=\"language-text\">mobx</code>도 같은 맥락으로 이해하면 된다).</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4ffd05ad596b4d70fec4e1684dcb287c/67fb6/redux-cycle.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 307px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 53.420195439739416%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABt0lEQVQoz3VRTY/TMBDtb0Ac+MW99lIQ6gmqnnpEotVyS6GU0krARquS5qNbQhKSON8fTuLYZlyXXSHBkxPZM/M8854HjLE8z/u+55wzysQS4A8QJ8ooFaGqLC3L8n1fpgZt204mE03TrnVQSSnsFUWZvnq9XCzkEdA0zWq1SpJkt9udTidBTtN0u93q+tF34x+H1LpFn95atOPvV8qzJ09n0ynOufE1uFWcLC6Wy8XNzbv5fA79BRkujuMYRSjPijonedwEdsEoh/jL5y/Ksuwwi7zS0dOuJdBTVdX1eh0EgSBjjMMwdBwHlMvJhbaqiqIoyzIIYlw/6Ie4YRie5101g3rXc3/5nm3b0jP4Q1rX9fP5DOPJJjKOEIIy0zTrWtw4gC9HTeRWF2f5/yAGumTrokt8LCOCbHwBP35eK/4AvM0ugOd45HOeBvX9XSQFCjJySltLYEN7KjV3pNtsNvv9HhwCe0hHM1S3mPSEgp1/kcukUT845rcQRris0DkFx6MGXlZV/V07uGby8Y11f4csNTx89kK7eBxb9CS078QibU8JwzWezWaj0Wg4HI7HY9JB+h9G/AaNGGDfVjweOAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"redux-cycle\"\n        title=\"\"\n        src=\"/static/4ffd05ad596b4d70fec4e1684dcb287c/67fb6/redux-cycle.png\"\n        srcset=\"/static/4ffd05ad596b4d70fec4e1684dcb287c/ee8a1/redux-cycle.png 148w,\n/static/4ffd05ad596b4d70fec4e1684dcb287c/b8043/redux-cycle.png 295w,\n/static/4ffd05ad596b4d70fec4e1684dcb287c/67fb6/redux-cycle.png 307w\"\n        sizes=\"(max-width: 307px) 100vw, 307px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>위와 같이 <code class=\"language-text\">redux</code>를 활용하면 흔히 <code class=\"language-text\">store</code>라고 표현하는 단 하나의 데이터 저장소를 통해 컴포넌트의 종속되지 않고 데이터를 전달하기 위해 <code class=\"language-text\">action</code>과 <code class=\"language-text\">reducer</code>로 표현되는 개념들을 활용하여 상태를 관리해준다. 그림과 같이 상태값을 업데이트하기 위해 컴포넌트에서 <code class=\"language-text\">action</code> 을 요청한 뒤 <code class=\"language-text\">reducer</code> 에서 상태값을 변경한 후 <code class=\"language-text\">store</code> 에 넘겨주게 되면 업데이트된 상태값을 통해 컴포넌트가 갱신되는 구조이다. 다만 이러한 개념을 이해하고 기본 설정부터 컴포넌트에 상태값을 연결하기 위해 <code class=\"language-text\">redux</code>에서 제공하는 기능들을 이해하는 과정이 복잡하다고 생각하며 나 역시 이러한 부분을 이해하기가 쉽지 않았다.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0fa862157b5ee8ddc77889309661f991/4b221/mobx-cycle.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 34.086444007858546%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABVElEQVQoz5WRzUrDQBDH8woefQrxIXwF6TN49iA+gODJg9CDKFTEKtZPpFYorVCL4EWxh7YIVmtb+5E0bZJukza7/3GzKZqjDvvbGWaH3Zn/agAoYvC5UH4GQQi5RBjLWgS7CgDDG+PdHpIEPZepEq3b07Fz06H1RIPSjwbBs5AqVCm2mabVvQJZ9ogGQ5Nuqyd0Wtql4+c4VdolIpfTcu6K5g62aT4Zx1ImFV449TmSd11sHH2gWHZUZ7mXBtYSRWxdPoGLoB+B+1oG2dczpMuHqA/eVN3KQxYL5wksXuwjlr9WOW02qWSsosnUj0pA3PfJl5AIxofyQsrCOSdnzGjAGDF57vGpqtdmukE3TEkfZr8P23Fg2SGMMcWIjaT/xXVdTDwPEb2VthrCX/k3wSOWbcFxGAzzC5V6/mdk/MEoSmC6rlOz2USn00Wr/Um1VknlvwHh3Qtcwkv/6gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"mobx-cycle\"\n        title=\"\"\n        src=\"/static/0fa862157b5ee8ddc77889309661f991/fb8a0/mobx-cycle.png\"\n        srcset=\"/static/0fa862157b5ee8ddc77889309661f991/1a291/mobx-cycle.png 148w,\n/static/0fa862157b5ee8ddc77889309661f991/2bc4a/mobx-cycle.png 295w,\n/static/0fa862157b5ee8ddc77889309661f991/fb8a0/mobx-cycle.png 590w,\n/static/0fa862157b5ee8ddc77889309661f991/526de/mobx-cycle.png 885w,\n/static/0fa862157b5ee8ddc77889309661f991/fa2eb/mobx-cycle.png 1180w,\n/static/0fa862157b5ee8ddc77889309661f991/08f6a/mobx-cycle.png 1770w,\n/static/0fa862157b5ee8ddc77889309661f991/4b221/mobx-cycle.png 2036w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p><code class=\"language-text\">mobx</code>의 경우 <code class=\"language-text\">redux</code>와 비슷한 흐름으로 데이터를 관리한다고 볼 수 있지만 기본 설정 및 상태를 접근하는 방식에서 차이가 있다. 우선 객체지향적인 설계를 지원하기 때문에 <code class=\"language-text\">Classes</code> 문법을 활용하여 생각보다 쉽게 설계와 구현이 가능했고, 컴포넌트와 상태값을 연결하기 위한 설정을 <code class=\"language-text\">Decorator</code> 문법을 활용하여 <code class=\"language-text\">redux</code>를 사용할때 보다 복잡한 과정을 거치지 않는다. 무엇보다 <code class=\"language-text\">observer</code>, <code class=\"language-text\">observable</code>이라는 개념을 통해 컴포넌트에서 요청하는 <code class=\"language-text\">action</code>에 따라 상태값의 변경하는 과정을 이해하는데 있어 <code class=\"language-text\">redux</code> 보다 좀 쉬웠다.</p>\n<p>사실 <code class=\"language-text\">redux</code>와 <code class=\"language-text\">mobx</code>를 좀 더 이해한 후 자세히 설명하고 싶지만 현재로서는 개인적인 지식이 아직 많이 부족하기 때문에 이쯤에서 정리하려고 한다. 나중에 시간이 되면 정리하도록 하고 <code class=\"language-text\">redux</code> 와 <code class=\"language-text\">mobx</code>를 어떻게 활용했는지 정리해보자.</p>\n<h2>react-redux</h2>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/321f364bd91c086d1f0df0121761ce44/90e0b/react-redux.jpeg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 25.78125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMC/8QAFQEBAQAAAAAAAAAAAAAAAAAABAD/2gAMAwEAAhADEAAAAZ0GF0If/8QAFRABAQAAAAAAAAAAAAAAAAAAARD/2gAIAQEAAQUCL//EABcRAQADAAAAAAAAAAAAAAAAAAABAxH/2gAIAQMBAT8Bslr/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAZEAEAAgMAAAAAAAAAAAAAAAARAAEQIUH/2gAIAQEAAT8h04ygDH//2gAMAwEAAgADAAAAEIQf/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAEDAQE/EGlbf//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABkQAQEBAQEBAAAAAAAAAAAAAAERAEEhUf/aAAgBAQABPxCELD472Qr3pgJv/9k='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"react-redux\"\n        title=\"\"\n        src=\"/static/321f364bd91c086d1f0df0121761ce44/f8fb9/react-redux.jpeg\"\n        srcset=\"/static/321f364bd91c086d1f0df0121761ce44/e8976/react-redux.jpeg 148w,\n/static/321f364bd91c086d1f0df0121761ce44/63df2/react-redux.jpeg 295w,\n/static/321f364bd91c086d1f0df0121761ce44/f8fb9/react-redux.jpeg 590w,\n/static/321f364bd91c086d1f0df0121761ce44/85e3d/react-redux.jpeg 885w,\n/static/321f364bd91c086d1f0df0121761ce44/d1924/react-redux.jpeg 1180w,\n/static/321f364bd91c086d1f0df0121761ce44/9452e/react-redux.jpeg 1770w,\n/static/321f364bd91c086d1f0df0121761ce44/90e0b/react-redux.jpeg 1920w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>앞서 설명한대로 <code class=\"language-text\">redux</code>는 JavaScript 환경에서 사용 가능하지만 react 개발 환경에서 좀 더 쉽게 사용할 수 있도록 <code class=\"language-text\">react-redux</code>라는 라이브러리를 사용했다. 그리고 <code class=\"language-text\">action</code> 구현을 쉽게 설정할 수 있는 <code class=\"language-text\">redux-actions</code> 라이브러리를 사용했다. 우선 관련 라이브러리를 설치하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">yarn add --dev redux react-redux redux-actions</code></pre></div>\n<p>이제 <code class=\"language-text\">redux</code>를 활용하여 간단한 카운터를 만들어보려 한다. 우선 컴포넌트에서 요청에 필요한 <code class=\"language-text\">action</code> 과 <code class=\"language-text\">reducer</code>를 구현하도록 하자.</p>\n<ul>\n<li><code class=\"language-text\">src/redux/reducers/counter.js</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> handleActions<span class=\"token punctuation\">,</span> createAction <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'redux-actions'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">INCREMENT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'INCREMENT'</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">DECREMENT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'DECREMENT'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> increment <span class=\"token operator\">=</span> <span class=\"token function\">createAction</span><span class=\"token punctuation\">(</span><span class=\"token constant\">INCREMENT</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> decrement <span class=\"token operator\">=</span> <span class=\"token function\">createAction</span><span class=\"token punctuation\">(</span><span class=\"token constant\">DECREMENT</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> initialState <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  count<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">handleActions</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">[</span><span class=\"token constant\">INCREMENT</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> state <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> count<span class=\"token punctuation\">:</span> state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token constant\">DECREMENT</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> state <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> count<span class=\"token punctuation\">:</span> state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  initialState\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>우선 <code class=\"language-text\">redux-actions</code>에서 제공하는 <code class=\"language-text\">createAction</code> 함수를 통해 <code class=\"language-text\">increment</code>, <code class=\"language-text\">decrement</code>라는 <code class=\"language-text\">action</code>를 생성했다. 컴포넌트에서 요청한 <code class=\"language-text\">action</code>의 종류에 따라 기본 객체 프로퍼티인 <code class=\"language-text\">count</code> 값을 가감하도록 설정했다. 만들어진 <code class=\"language-text\">action</code> 은<code class=\"language-text\">createAction</code> 호출 시 인자로 넘겨받은 타입에 맞춰 <code class=\"language-text\">handleActions</code> 함수를 통해 상태값을 변경하도록 했다.</p>\n<ul>\n<li><code class=\"language-text\">src/redux/reducers/index.js</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> combineReducers <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'redux'</span>\n<span class=\"token keyword\">import</span> counter <span class=\"token keyword\">from</span> <span class=\"token string\">'./counter'</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">combineReducers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  counter<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>생성된 <code class=\"language-text\">reducer</code>를 <code class=\"language-text\">store</code>에 전달하기 위한 파일을 생성했다. <code class=\"language-text\">combineReducers</code>라는 함수를 통해 <code class=\"language-text\">reducer</code>를 전달하도록 했다.</p>\n<ul>\n<li><code class=\"language-text\">src/redux/store.js</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> createStore <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'redux'</span>\n<span class=\"token keyword\">import</span> reducers <span class=\"token keyword\">from</span> <span class=\"token string\">'./reducers'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">createStore</span><span class=\"token punctuation\">(</span>reducers<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">reducer</code>를 통해 갱신된 데이터를 컴포넌트에 전달하는 <code class=\"language-text\">store</code>를 생생했다. 이제 생성된 <code class=\"language-text\">store</code>를 클라이언트 영역에서 전달받기 위한 작업을 진행해보자</p>\n<h3>Client</h3>\n<ul>\n<li><code class=\"language-text\">src/index.js</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// ...</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Provider <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-redux'</span>\n<span class=\"token keyword\">import</span> store <span class=\"token keyword\">from</span> <span class=\"token string\">'./redux/store'</span>\n\nReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>BrowserRouter<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Provider store<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">store</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>App <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Provider<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>BrowserRouter<span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p><code class=\"language-text\">react-redux</code> 에서 제공하는 <code class=\"language-text\">Provider</code> 컴포넌트를 통해 <code class=\"language-text\">store</code>로터 전달받은 상태 괸리 객체를 최상위 컴포넌트인 <code class=\"language-text\">App</code>에 전달하도록 했다. 이제 <code class=\"language-text\">App</code> 컴포넌트를 통해 설정된 전역 데이터를 활용하기 위한 컴포넌트 작업을 진행해보자.</p>\n<ul>\n<li><code class=\"language-text\">src/components/Counter.jsx</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Component <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> connect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-redux'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> bindActionCreators <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'redux'</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> counterActions <span class=\"token keyword\">from</span> <span class=\"token string\">'../redux/reducers/counter'</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Counter</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> counter<span class=\"token punctuation\">,</span> CounterActions <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>counter<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>button\n          onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n            CounterActions<span class=\"token punctuation\">.</span><span class=\"token function\">increment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">></span>\n          <span class=\"token operator\">+</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>button\n          onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n            CounterActions<span class=\"token punctuation\">.</span><span class=\"token function\">decrement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">></span>\n          <span class=\"token operator\">-</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>\n  state <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    counter<span class=\"token punctuation\">:</span> state<span class=\"token punctuation\">.</span>counter<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  dispatch <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    CounterActions<span class=\"token punctuation\">:</span> <span class=\"token function\">bindActionCreators</span><span class=\"token punctuation\">(</span>counterActions<span class=\"token punctuation\">,</span> dispatch<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>Counter<span class=\"token punctuation\">)</span></code></pre></div>\n<p>전달받은 카운터 데이터를 활용할 수 있도록 <code class=\"language-text\">Counter</code>라는 새로운 컴포넌트를 만들었다. <code class=\"language-text\">react-redux</code> 에서 제공하는 <code class=\"language-text\">connect</code> 함수를 통해 <code class=\"language-text\">store</code>로부터 전달받은 <code class=\"language-text\">counter</code> 객체와 해당 객체에 <code class=\"language-text\">action</code>을 요청할 수 있도록 <code class=\"language-text\">redux</code>에서 제공하는 <code class=\"language-text\">bindActionCreators</code> 함수를 통해 <code class=\"language-text\">CounterActions</code>이라는 새로운 객체를 <code class=\"language-text\">HoC</code> 패턴을 활용해 해당 컴포넌트의 주입했다.</p>\n<p>컴포넌트 구조는 전달받은 <code class=\"language-text\">counter</code> 객체를 확인하기 위한 요소와 증가/감소 버튼으로 구성되었고 버튼 클릭 시 <code class=\"language-text\">CounterActions</code> 에 설정된 <code class=\"language-text\">action</code>을 호출하도록 했다. 이제 만들어진 컴포넌트를 사용하기 위해 <code class=\"language-text\">Home</code>, <code class=\"language-text\">About</code> 컴포넌트를 수정해보자.</p>\n<ul>\n<li><code class=\"language-text\">src/components/Home.jsx</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> withLayout <span class=\"token keyword\">from</span> <span class=\"token string\">'./withLayout'</span>\n<span class=\"token keyword\">import</span> Counter <span class=\"token keyword\">from</span> <span class=\"token string\">'./Counter'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Home</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span>home<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Counter <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">withLayout</span><span class=\"token punctuation\">(</span>Home<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">src/components/About.jsx</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> withLayout <span class=\"token keyword\">from</span> <span class=\"token string\">'./withLayout'</span>\n<span class=\"token keyword\">import</span> Counter <span class=\"token keyword\">from</span> <span class=\"token string\">'./Counter'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">About</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span>About<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Counter <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">withLayout</span><span class=\"token punctuation\">(</span>About<span class=\"token punctuation\">)</span></code></pre></div>\n<p><code class=\"language-text\">Home</code>, <code class=\"language-text\">About</code> 컴포넌트 내부에 <code class=\"language-text\">Counter</code> 컴포넌트를 호출하도록 수정했다. 렌더링 시 컴포넌트를 호출하는 것 이외에 특별한 작업을 하지 않았다. 이제 화면을 동작시켜 결과를 확인해보자.</p>\n<p><img src=\"/redux-client-05d38dffbcd810c12275dbc621024e73.gif\" alt=\"redux-client\"></p>\n<p><code class=\"language-text\">action</code> 요청 후 업데이트되는 상태값을 컴포넌트에 종속되지 않고 정상적으로 전달받는 것을 확인했다. 이제 서버 영역에서도 <code class=\"language-text\">store</code>로부터 데이터를 전달받기 위한 작업을 진행해보자.</p>\n<h3>Server</h3>\n<p>서버 렌더링 시에는 <code class=\"language-text\">store</code> 로부터 초기 전역 상태값을 전달받기 위한 작업이 필요하다. 해당 작업을 진행하기 위해 <code class=\"language-text\">renderer.js</code> 파일을 수정해보자.</p>\n<ul>\n<li><code class=\"language-text\">src/lib/renderer.js</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// ...</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Provider <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-redux'</span>\n<span class=\"token keyword\">import</span> store <span class=\"token keyword\">from</span> <span class=\"token string\">'../redux/store'</span>\n\n<span class=\"token keyword\">const</span> renderer <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> req<span class=\"token punctuation\">,</span> html <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n\n  <span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">renderToString</span><span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>Loadable<span class=\"token punctuation\">.</span>Capture report<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>moduleName <span class=\"token operator\">=></span> modules<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>moduleName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>StaticRouter location<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>req<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">}</span> context<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>context<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Provider store<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">store</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>App <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Provider<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>StaticRouter<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Loadable<span class=\"token punctuation\">.</span>Capture<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> renderer</code></pre></div>\n<p>이 전에 클라이언트 영역에서 구현했던 것처럼 서버측에서도 <code class=\"language-text\">Provider</code> 컴포넌트를 통해 <code class=\"language-text\">store</code> 로터 전달받은 상태 관리 객체를 최상위 컴포넌트인 <code class=\"language-text\">App</code>에 전달하도록 했다. 서버 측에서 필요한 구현은 끝났으니 실행 결과를 확인해보자.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b0ba7b0d3357b6a9576b64a71122a6a8/012bd/redux-server-src.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 57.223264540337716%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABX0lEQVQoz51S2XKDMAzk/3+uM81TGRJCSDCnsQM+gMBWJk1CaIeHakaWD3l1rLw2VxBRjqYUqKoOg+0BTJgmWqfpT3Wy3C/Fc4sqNVShVk+/nZ8vK+A3wMdZlS1ctrrm0DyDvg5IWQGecbRVCyssbv0N4zi+ga7Ve0Qw0qD0Oapwj/qwQxgM2H32iPyE7AfS4II6JHDWbCX/AuwaC3GSkMkF8hwgPg4IgglxdIP/VSIksPxUIjkmYCeGPMup5xW0UDBCo1fdKkO61NRLKyUpORcjGBtR5CMoBtIU4KVFkpzBUgaWMMRxjCIlQvMrDNfoCHQmxfWF7yvqVQNtDTE9bJKyRdYzQysMMj+liAUxTiRc7Qzcm37WwdBeO0tn+2Pp7Ihasv0EdJ9lLGYg52iJJENBbGvvVt7V1FQa3Tk/V+a9mhfrc8kuSh3VNDIa/5HlLHpd24EfqrnMrfna0iXoN8/AWdD5pnA7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"redux-server-src\"\n        title=\"\"\n        src=\"/static/b0ba7b0d3357b6a9576b64a71122a6a8/fb8a0/redux-server-src.png\"\n        srcset=\"/static/b0ba7b0d3357b6a9576b64a71122a6a8/1a291/redux-server-src.png 148w,\n/static/b0ba7b0d3357b6a9576b64a71122a6a8/2bc4a/redux-server-src.png 295w,\n/static/b0ba7b0d3357b6a9576b64a71122a6a8/fb8a0/redux-server-src.png 590w,\n/static/b0ba7b0d3357b6a9576b64a71122a6a8/526de/redux-server-src.png 885w,\n/static/b0ba7b0d3357b6a9576b64a71122a6a8/012bd/redux-server-src.png 1066w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>서버 실행 후 페이지 소스를 확인해보니 정상적으로 서버 렌더링 시 전달받은 데이터를 화면에 그려주고 있다.</p>\n<p>지금까지 활용한 예제는 동기적인 데이터이기 때문에 클라이언트 및 서버 영역에서의 <code class=\"language-text\">redux</code> 설정 방법은 생각보다 간단했다. 이제 이 전에 다룬 비동기 데이터를 <code class=\"language-text\">redux</code>를 활용하여 처리하는 방법에 대한 내용을 정리해보자.</p>\n<h2>redux-thunk</h2>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1958a6c91b0b9c1801d873cb30b79acf/778cc/redux-thunk.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 75.07836990595611%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAQAD/8QAFwEAAwEAAAAAAAAAAAAAAAAAAQIDBf/aAAwDAQACEAMQAAAB1ErlURX/xAAXEAADAQAAAAAAAAAAAAAAAAAAESEQ/9oACAEBAAEFAqUY9//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABoQAQACAwEAAAAAAAAAAAAAAAEAMRARIVH/2gAIAQEAAT8he27ii1m3rHp5F2Vj/9oADAMBAAIAAwAAABCoH//EABcRAAMBAAAAAAAAAAAAAAAAAAABEVH/2gAIAQMBAT8Qc0rP/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8QJ//EABsQAQACAwEBAAAAAAAAAAAAAAEAESFBYXHh/9oACAEBAAE/ELmGtqz2J0B9h9aVFou+zGYQJ//Z'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"redux-thunk\"\n        title=\"\"\n        src=\"/static/1958a6c91b0b9c1801d873cb30b79acf/f8fb9/redux-thunk.jpg\"\n        srcset=\"/static/1958a6c91b0b9c1801d873cb30b79acf/e8976/redux-thunk.jpg 148w,\n/static/1958a6c91b0b9c1801d873cb30b79acf/63df2/redux-thunk.jpg 295w,\n/static/1958a6c91b0b9c1801d873cb30b79acf/f8fb9/redux-thunk.jpg 590w,\n/static/1958a6c91b0b9c1801d873cb30b79acf/778cc/redux-thunk.jpg 638w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p><code class=\"language-text\">redux</code>를 사용하는 경우 전역 상태를 관리할때 동기적인 데이터의 경우 기본적인 기능을 통해 활용할 수 있지만 비동기 데이터를 처리하기 위해서는 미들웨어가 필요하다. 그러한 미들웨어 중 하나가 <code class=\"language-text\">redux-thunk</code>이며 이를 통해 <code class=\"language-text\">action</code> 호출 시 동기적으로 전달되는 객체를 함수 또는 <code class=\"language-text\">Promises</code>로 감싼뒤 비동기적으로 반환하게 해줄 수 있게 도와준다.</p>\n<p>우선 <code class=\"language-text\">redux-thunk</code>를 설치하고 미들웨어를 연결하기 위한 작업을 진행하도록 하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">yarn add --dev redux-thunk</code></pre></div>\n<ul>\n<li><code class=\"language-text\">src/redux/store.js</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> createStore<span class=\"token punctuation\">,</span> applyMiddleware <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'redux'</span>\n<span class=\"token keyword\">import</span> reducers <span class=\"token keyword\">from</span> <span class=\"token string\">'./reducers'</span>\n<span class=\"token keyword\">import</span> ReduxThunk <span class=\"token keyword\">from</span> <span class=\"token string\">'redux-thunk'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">createStore</span><span class=\"token punctuation\">(</span>reducers<span class=\"token punctuation\">,</span> <span class=\"token function\">applyMiddleware</span><span class=\"token punctuation\">(</span>ReduxThunk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">redux</code>에서 제공하는 <code class=\"language-text\">applyMiddleware</code>라는 함수를 통해 <code class=\"language-text\">store</code> 생성 시 <code class=\"language-text\">redux-thunk</code>를 사용할 수 있도록 수정했다. 이제 비동기 액션을 처리하기 위한 <code class=\"language-text\">reducer</code>를 만들어보자.</p>\n<ul>\n<li><code class=\"language-text\">src/redux/reducers/post.js</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> handleActions<span class=\"token punctuation\">,</span> createAction <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'redux-actions'</span>\n<span class=\"token keyword\">import</span> axios <span class=\"token keyword\">from</span> <span class=\"token string\">'axios'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">GET_POST_LOADING</span> <span class=\"token operator\">=</span> <span class=\"token string\">'GET_POST_LOADING'</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">GET_POST_SUCCESS</span> <span class=\"token operator\">=</span> <span class=\"token string\">'GET_POST_SUCCESS'</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">GET_POST_ERROR</span> <span class=\"token operator\">=</span> <span class=\"token string\">'GET_POST_ERROR'</span>\n\n<span class=\"token keyword\">const</span> loading <span class=\"token operator\">=</span> <span class=\"token function\">createAction</span><span class=\"token punctuation\">(</span><span class=\"token constant\">GET_POST_LOADING</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> success <span class=\"token operator\">=</span> <span class=\"token function\">createAction</span><span class=\"token punctuation\">(</span><span class=\"token constant\">GET_POST_SUCCESS</span><span class=\"token punctuation\">,</span> res <span class=\"token operator\">=></span> res<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> error <span class=\"token operator\">=</span> <span class=\"token function\">createAction</span><span class=\"token punctuation\">(</span><span class=\"token constant\">GET_POST_ERROR</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getPost</span> <span class=\"token operator\">=</span> path <span class=\"token operator\">=></span> dispatch <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">loading</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  axios<span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`https://jsonplaceholder.typicode.com</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>path<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>\n    res <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">success</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> initialState <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  pending<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  error<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  data<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">handleActions</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">[</span><span class=\"token constant\">GET_POST_LOADING</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        pending<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n        error<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n        data<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token constant\">GET_POST_SUCCESS</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">let</span> data <span class=\"token operator\">=</span> Array<span class=\"token punctuation\">.</span><span class=\"token function\">isArray</span><span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span>payload<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">?</span> action<span class=\"token punctuation\">.</span>payload\n        <span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>action<span class=\"token punctuation\">.</span>payload<span class=\"token punctuation\">]</span>\n\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        pending<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n        error<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n        data<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token constant\">GET_POST_ERROR</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        pending<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n        error<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n        data<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  initialState\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>비동기 요청 시 반환 상태에 따른 <code class=\"language-text\">loading</code>, <code class=\"language-text\">success</code>, <code class=\"language-text\">error</code>라는 <code class=\"language-text\">action</code>을 생성했다. 비동기 데이터 요청 시 반환되는 <code class=\"language-text\">pending</code>, <code class=\"language-text\">resolve</code>, <code class=\"language-text\">reject</code> 상태에 따라 각 액션을 호출하도록 구현했다. 다만 비동기 요청 시 반환 상태에 따라 <code class=\"language-text\">dispatch</code> 함수를 통해 일일히 <code class=\"language-text\">action</code>을 요청해야 하기 때문에 기존에 사용했던 비동기 요청 함수를 사용하지 못하는 부분이 조금 아쉽다.</p>\n<p>다행히도 이러한 비동기 상태에 따라 액션을 자동으로 생성히 주는 라이브러리가 있어 이를 활용했다. <code class=\"language-text\">redux-promise-middleware</code>라는 미들웨어를 활용하여 코드를 개선해보자.</p>\n<p>우선 라이브러리를 사용하기 위해 설치부터 진행하도록 하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">yarn add --dev redux-promise-middleware</code></pre></div>\n<p>설치한 미들웨어를 사용하기 위해 <code class=\"language-text\">store</code> 파일에 수정하도록 하자.</p>\n<ul>\n<li><code class=\"language-text\">src/redux/store.js</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> createStore<span class=\"token punctuation\">,</span> applyMiddleware <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'redux'</span>\n<span class=\"token keyword\">import</span> reducers <span class=\"token keyword\">from</span> <span class=\"token string\">'./reducers'</span>\n<span class=\"token keyword\">import</span> ReduxThunk <span class=\"token keyword\">from</span> <span class=\"token string\">'redux-thunk'</span>\n<span class=\"token keyword\">import</span> promiseMiddleware <span class=\"token keyword\">from</span> <span class=\"token string\">'redux-promise-middleware'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">createStore</span><span class=\"token punctuation\">(</span>\n    reducers<span class=\"token punctuation\">,</span>\n    <span class=\"token function\">applyMiddleware</span><span class=\"token punctuation\">(</span>\n      ReduxThunk<span class=\"token punctuation\">,</span>\n      <span class=\"token function\">promiseMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        promiseTypeSuffixes<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'LOADING'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'SUCCESS'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ERROR'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">applyMiddleware</code> 함수 호출 시 해당 미들웨어를 사용하도록 <code class=\"language-text\">promiseMiddleware</code> 함수의 반환 값을 인자에 추가했다. <code class=\"language-text\">promiseMiddleware</code>의 인자로는 액션 생성 시 연결할 문자열을 옵션으로 추가했다. 이를 통해 비동기 요청 상태에 따라 <code class=\"language-text\">_LOADING</code>, <code class=\"language-text\">_SUCCESS</code>, <code class=\"language-text\">_ERROR</code>라는 접미사가 추가된 액션이 생성하도록 설정했다.</p>\n<p>이제 이 전에 구현했던 비동기 요청을 통해 액션을 요청하는 영역을 수정해보자.</p>\n<ul>\n<li><code class=\"language-text\">src/redux/reducers/post.js</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> handleActions<span class=\"token punctuation\">,</span> createAction <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'redux-actions'</span>\n<span class=\"token keyword\">import</span> loadData <span class=\"token keyword\">from</span> <span class=\"token string\">'../../lib/loadData'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">GET_POST</span> <span class=\"token operator\">=</span> <span class=\"token string\">'GET_POST'</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">GET_POST_LOADING</span> <span class=\"token operator\">=</span> <span class=\"token string\">'GET_POST_LOADING'</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">GET_POST_SUCCESS</span> <span class=\"token operator\">=</span> <span class=\"token string\">'GET_POST_SUCCESS'</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">GET_POST_ERROR</span> <span class=\"token operator\">=</span> <span class=\"token string\">'GET_POST_ERROR'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> getPost <span class=\"token operator\">=</span> <span class=\"token function\">createAction</span><span class=\"token punctuation\">(</span>\n  <span class=\"token constant\">GET_POST</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">async</span> path <span class=\"token operator\">=></span> <span class=\"token keyword\">await</span> <span class=\"token function\">loadData</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// ...</span></code></pre></div>\n<p>반환 상태에 따라 <code class=\"language-text\">createAction</code> 함수를 통해 생성한 액션 함수를 비동기 요청 시 직접 호출하지 않도록 수정했다. <code class=\"language-text\">GET_POST</code>라는 액션 생성 시 미들웨어를 통해 비동기 요청 상태에 따라 액션을 자동으로 생성하도록 요청했고 이를 통해 기존의 <code class=\"language-text\">loadData</code> 함수를 사용할 수 있도록 수정했다.</p>\n<p>그럼 이제 구현한 <code class=\"language-text\">reducer</code>를 <code class=\"language-text\">store</code>에 전달하도록 하자.</p>\n<ul>\n<li><code class=\"language-text\">src/redux/reducer/index.js</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> combineReducers <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'redux'</span>\n<span class=\"token keyword\">import</span> counter <span class=\"token keyword\">from</span> <span class=\"token string\">'./counter'</span>\n<span class=\"token keyword\">import</span> post <span class=\"token keyword\">from</span> <span class=\"token string\">'./post'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">combineReducers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  counter<span class=\"token punctuation\">,</span>\n  post<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>새롭게 구현한 <code class=\"language-text\">post reducer</code>를 <code class=\"language-text\">store</code>에 주입하도록 설정했다. 이제 비동기 데이터를 활용하기 위해 컴포넌트 영역을 수정하도록 하자.</p>\n<h3>Client</h3>\n<p><code class=\"language-text\">redux-thunk</code>를 통한 비동기 데이터를 활용하기 위해 기존에 사용했던 <code class=\"language-text\">Posts</code> 컴포넌트를 수정했다.</p>\n<ul>\n<li><code class=\"language-text\">src/components/Posts.jsx</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Component <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> withLayout <span class=\"token keyword\">from</span> <span class=\"token string\">'./withLayout'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> connect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-redux'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> bindActionCreators <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'redux'</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> postActions <span class=\"token keyword\">from</span> <span class=\"token string\">'../redux/reducers/post'</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Posts</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> PostActions<span class=\"token punctuation\">,</span> match <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props\n    PostActions<span class=\"token punctuation\">.</span><span class=\"token function\">getPost</span><span class=\"token punctuation\">(</span>match<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> post <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n        <span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>loading <span class=\"token operator\">&amp;&amp;</span> <span class=\"token string\">'...loading'</span><span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>error <span class=\"token operator\">&amp;&amp;</span> <span class=\"token string\">'error!'</span><span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n          <span class=\"token operator\">&lt;</span>div key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>i<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>\n  state <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    post<span class=\"token punctuation\">:</span> state<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  dispatch <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    PostActions<span class=\"token punctuation\">:</span> <span class=\"token function\">bindActionCreators</span><span class=\"token punctuation\">(</span>postActions<span class=\"token punctuation\">,</span> dispatch<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token function\">withLayout</span><span class=\"token punctuation\">(</span>Posts<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>우선 라우터를 통해 비동기 데이터를 활용하기 위해 구현했던 이 전 코드는 지우고 <code class=\"language-text\">redux-thunk</code>를 활용하기 위해 수정된 코드의 내용이다. <code class=\"language-text\">Counter</code> 컴포넌트를 구현할때와 마찬가지로 <code class=\"language-text\">connect</code> 함수를 통해 전역 상태와 <code class=\"language-text\">action</code> 함수를 전달받도록 수정했다. 이 후 <code class=\"language-text\">componentDidMount</code> 함수 호출 시 라우팅 정보에 따른 <code class=\"language-text\">action</code> 호출을 통해 비동기 데이터를 전달받도록 수정했다. 렌더링 시에는 요청 상태에 따른 화면 구성을 구분할 수 있도록 구현했다. 그럼 이제 해당 코드가 잘 동작하는지 확인해보자.</p>\n<p><img src=\"/redux-thunk-client-b0b4a9885d017b4e6bc230aaa52af72c.gif\" alt=\"redux-thunk-client\"></p>\n<p>컴포넌트 렌더링 시 비동기적인 액션 호출을 통해 정상적으로 비동기 데이터를 전달받는 것을 확인했다.</p>\n<h3>Server</h3>\n<p>이제 서버에서 비동기 데이터를 정상적으로 렌더링할 수 있도록 작업을 진행해보자. 우선 서버 측에서 라우터 주소에 따라 <code class=\"language-text\">action</code>을 호출하기 위한 작업이 필요하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// ...</span>\n<span class=\"token keyword\">import</span> store <span class=\"token keyword\">from</span> <span class=\"token string\">'../redux/store'</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> postActions <span class=\"token keyword\">from</span> <span class=\"token string\">'../redux/reducers/post'</span>\n\n<span class=\"token comment\">// ...</span>\n\n<span class=\"token keyword\">const</span> initStore <span class=\"token operator\">=</span> <span class=\"token function\">store</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> Routes <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">{</span>\n    path<span class=\"token punctuation\">:</span> <span class=\"token string\">'/posts/:id'</span><span class=\"token punctuation\">,</span>\n    component<span class=\"token punctuation\">:</span> <span class=\"token function\">Loadable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      loader<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../components/Posts'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      loading<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    loadData<span class=\"token punctuation\">:</span> <span class=\"token keyword\">async</span> path <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">await</span> initStore<span class=\"token punctuation\">.</span><span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span>postActions<span class=\"token punctuation\">.</span><span class=\"token function\">getPost</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">return</span> initStore<span class=\"token punctuation\">.</span><span class=\"token function\">getState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    path<span class=\"token punctuation\">:</span> <span class=\"token string\">'/posts'</span><span class=\"token punctuation\">,</span>\n    component<span class=\"token punctuation\">:</span> <span class=\"token function\">Loadable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      loader<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../components/Posts'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      loading<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    loadData<span class=\"token punctuation\">:</span> <span class=\"token keyword\">async</span> path <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">await</span> initStore<span class=\"token punctuation\">.</span><span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span>postActions<span class=\"token punctuation\">.</span><span class=\"token function\">getPost</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">return</span> initStore<span class=\"token punctuation\">.</span><span class=\"token function\">getState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Routes</code></pre></div>\n<p>기존 <code class=\"language-text\">loadData</code> 함수에서 비동기 요청에 대한 응답 데이터를 반환하지 않고 <code class=\"language-text\">store</code>를 생성한 뒤 해당 라우터 주소에 따라 새로운 전역 상태에 대한 데이터를 반환하도록 수정했다.</p>\n<ul>\n<li><code class=\"language-text\">src/lib/renderer.js</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// ...</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Provider <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-redux'</span>\n<span class=\"token keyword\">import</span> store <span class=\"token keyword\">from</span> <span class=\"token string\">'../redux/store'</span>\n\n<span class=\"token keyword\">const</span> renderer <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> req<span class=\"token punctuation\">,</span> html <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> currentRoute <span class=\"token operator\">=</span> routes<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span>route <span class=\"token operator\">=></span> <span class=\"token function\">matchPath</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">,</span> route<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">const</span> initState <span class=\"token operator\">=</span> currentRoute<span class=\"token punctuation\">.</span>loadData\n    <span class=\"token operator\">?</span> <span class=\"token keyword\">await</span> currentRoute<span class=\"token punctuation\">.</span><span class=\"token function\">loadData</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">const</span> initStore <span class=\"token operator\">=</span> <span class=\"token function\">store</span><span class=\"token punctuation\">(</span>initState<span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> context <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">let</span> modules <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">renderToString</span><span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>Loadable<span class=\"token punctuation\">.</span>Capture report<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>moduleName <span class=\"token operator\">=></span> modules<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>moduleName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>StaticRouter location<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>req<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">}</span> context<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>context<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Provider store<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>initStore<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>App <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Provider<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>StaticRouter<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Loadable<span class=\"token punctuation\">.</span>Capture<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">let</span> bundles <span class=\"token operator\">=</span> <span class=\"token function\">getBundles</span><span class=\"token punctuation\">(</span>stats<span class=\"token punctuation\">,</span> modules<span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    html<span class=\"token punctuation\">:</span> html<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span>\n      <span class=\"token string\">'&lt;div id=\"root\">&lt;/div>'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token template-string\"><span class=\"token string\">`&lt;div id=\"root\"></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>app<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/div>\n      &lt;script>window.__INIT_DATA__ = </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span>initStore<span class=\"token punctuation\">.</span><span class=\"token function\">getState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/script>\n      </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>bundles\n        <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>bundle <span class=\"token operator\">=></span> <span class=\"token operator\">!</span>bundle<span class=\"token punctuation\">.</span>file<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.map'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>bundle <span class=\"token operator\">=></span> `<span class=\"token operator\">&lt;</span>script src<span class=\"token operator\">=</span>\"$<span class=\"token punctuation\">{</span>bundle<span class=\"token punctuation\">.</span>publicPath<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\">&lt;/script>`</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n      `\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    context<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> renderer</code></pre></div>\n<p>서버 측 비동기 데이터 설정 시 기존에는 컴포넌트에 설정한 <code class=\"language-text\">loadData</code> 함수 요청 후 반환되는 비동기 데이터를 <code class=\"language-text\">context</code> 객체의 프로퍼티로 설정한 뒤 <code class=\"language-text\">StaticRouter</code>의 props로 전달해 주었다. 현재는 비동기 데이터를 포함한 전역 데이터를 새로운 <code class=\"language-text\">store</code> 함수 호출에 필요한 인자값으로 넘겨주고 있다. 이 후 새롭게 생성된 상태 객체를 <code class=\"language-text\">Provider</code> 컴포넌트이 props로 전달하도록 수정했다. 이 후 클라이언트에서 확인하기 위한 초기 전역 데이터 또한 <code class=\"language-text\">window.__INIT_DATA__</code>라는 새로운 객체를 통해 클라이언트에서 전달받을 수 있도록 수정했다.</p>\n<p>다만 기존에 구현된 <code class=\"language-text\">store</code> 생성함수는 초기 데이터값에 대한 인자를 따로 받지 않았기 때문에 <code class=\"language-text\">store</code> 생성 시 초기 전역 데이터를 전달받을 수 있도록 수정해야 하며 서버 렌더링 이후 클라이언트 렌더링 시에도 초기 전역 데이터를 전달받기 위한 수정이 필요하다.</p>\n<ul>\n<li><code class=\"language-text\">src/redux/store.js</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> createStore<span class=\"token punctuation\">,</span> applyMiddleware <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'redux'</span>\n<span class=\"token keyword\">import</span> reducers <span class=\"token keyword\">from</span> <span class=\"token string\">'./reducers'</span>\n<span class=\"token keyword\">import</span> ReduxThunk <span class=\"token keyword\">from</span> <span class=\"token string\">'redux-thunk'</span>\n<span class=\"token keyword\">import</span> promiseMiddleware <span class=\"token keyword\">from</span> <span class=\"token string\">'redux-promise-middleware'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span>initialState <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">createStore</span><span class=\"token punctuation\">(</span>\n    reducers<span class=\"token punctuation\">,</span>\n    initialState<span class=\"token punctuation\">,</span>\n    <span class=\"token function\">applyMiddleware</span><span class=\"token punctuation\">(</span>\n      ReduxThunk<span class=\"token punctuation\">,</span>\n      <span class=\"token function\">promiseMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        promiseTypeSuffixes<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'LOADING'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'SUCCESS'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ERROR'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>기존 함수 호출 시 비어있던 인자를 <code class=\"language-text\">initialState</code>라는 초기 전역 데이터를 갖는 인자로 수정했다. 이 후 함수 호출 시 전달받은 초기 전역 데이터를 <code class=\"language-text\">createStore</code> 함수의 인자로 추가했다.</p>\n<ul>\n<li><code class=\"language-text\">src/index.js</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// ...</span>\nReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>BrowserRouter<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Provider store<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">store</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>__INIT_DATA__ <span class=\"token operator\">||</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>App <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Provider<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>BrowserRouter<span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// ...</span></code></pre></div>\n<p>서버 렌더링 이후 요청되는 클라이언트 측 <code class=\"language-text\">store</code> 생성 함수의 인자로 서버에서 설정한 <code class=\"language-text\">window.__INIT_DATA__</code> 객체를 인수로 전달할 수 있도록 수정했다. 이를 통하 최초 서버 렌더링 이후 클라이언트 렌더링 시 서버에서 전달받은 초기 데이터를 통해 <code class=\"language-text\">store</code> 함수를 호출할 수 있다. 이제 서버 렌더링 이 후 추가적인 라우터 호출 시 컴포넌트 영역에서 <code class=\"language-text\">window.__INIT_DATA__</code> 객체 존재 여부에 따라 액션 호출 조건만 수정하면 된다.</p>\n<ul>\n<li><code class=\"language-text\">src/components/Counter.jsx</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Counter</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>__INIT_DATA__<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      window<span class=\"token punctuation\">.</span>__INIT_DATA__ <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">Counter</code> 컴포넌트에서 <code class=\"language-text\">componentDidMount</code> 함수 호출 시 <code class=\"language-text\">window.__INIT_DATA__</code> 객체가 존재할 경우 해당 객체를 비워주도록 설정했다. 최초 서버 렌더링 이후 클라이언트 영역에서 해당 객체를 참조하지 않기 위해서다</p>\n<ul>\n<li><code class=\"language-text\">src/components/Posts.jsx</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Posts</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> PostActions<span class=\"token punctuation\">,</span> match <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>__INIT_DATA__<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      window<span class=\"token punctuation\">.</span>__INIT_DATA__ <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      PostActions<span class=\"token punctuation\">.</span><span class=\"token function\">getPost</span><span class=\"token punctuation\">(</span>match<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">Posts</code> 컴포넌트 또한 <code class=\"language-text\">componentDidMount</code> 함수 호출 시 <code class=\"language-text\">window.__INIT_DATA__</code> 객체가 존재할 경우 해당 객체를 비워주도록 설정했다. 서버 렌더링 이후 클라이언트 영역에서 컴포넌트 재호출 시에는 새롭게 액션 함수 호출을 통해 전역 상태를 갱신할 수 있도록 수정했다.</p>\n<p>이제 서버 설정을 완료했으니 서버 실행 후 페이지 소스를 확인해보자.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e3b36ca221c3e154ae9352a92a8afce5/6919e/redux-thunk-server-src.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 68.9608636977058%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAABdklEQVQ4y61Ti27CMAzs///iyihjfZfSPEnSx80OFKGNIYSIdE3itGfnfE1MpyHLHloHLDPujmVZ/mCN/x4Jh0xn4KWDNxLOOIhBwQqDQEnmacaC5THpDW/CjylMELmAKneo9wN22xH77Q7NvoSuFEYbnq48Egb6YCAiVWxRZgM2G2CTWqQfkvYd9p9fKIoSTdVAdYpu40me5W6SSHg6nsBaemdhrSM9PZQKNE8wJIGUgiAhhIDVFieCdx4hBHjv4ZyL63mcz4SmpcbUAsZaIjBEpC6Ql72GNZaSKHrHRPI1zuthGGA0aW4CEt1ouqrEu0YiWoHqu4pZ2raNmcdxvCv4M0jYEnmRo6qqqMdt9/7z2sMK2UNN06Cu66jH8Xh8ubqrbfq+R5Zl6LruWuXLGkYfUsvTNI2ETM7gitfKD4dDlITPy7KMWq/nfMZznucxHgnZR9yMdWbw9dkmq0XYg2wTnjnGa26ktWc7cZyR8D9rhX2bbX4AS8VFL0fVguYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"redux-thunk-server-src\"\n        title=\"\"\n        src=\"/static/e3b36ca221c3e154ae9352a92a8afce5/fb8a0/redux-thunk-server-src.png\"\n        srcset=\"/static/e3b36ca221c3e154ae9352a92a8afce5/1a291/redux-thunk-server-src.png 148w,\n/static/e3b36ca221c3e154ae9352a92a8afce5/2bc4a/redux-thunk-server-src.png 295w,\n/static/e3b36ca221c3e154ae9352a92a8afce5/fb8a0/redux-thunk-server-src.png 590w,\n/static/e3b36ca221c3e154ae9352a92a8afce5/526de/redux-thunk-server-src.png 885w,\n/static/e3b36ca221c3e154ae9352a92a8afce5/fa2eb/redux-thunk-server-src.png 1180w,\n/static/e3b36ca221c3e154ae9352a92a8afce5/6919e/redux-thunk-server-src.png 1482w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p><code class=\"language-text\">Posts</code> 컴포넌트 호출 시 서버 측에서 초기 전역 데이터를 정상적으로 렌더링하는 것을 확인할 수 있다. 이 후 클라이언트 렌더링 또한 이상없이 동작하는 것을 확인할 수 있다.</p>\n<h2>redux-saga</h2>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f860bd1b76161ab4c3f39c95e4dd124e/b4c1c/redux-saga.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 20.875000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAA+0lEQVQY02OYOXMmw4yZM9xnzpgZOX3eVPmGX6HcXZcKBRmAYMas6ewMeEDnjVwuDEGggeJAA/NnTZ5rM2V1T0n7vUynjps5Dl2XC3RmTpsdC5SLAarRB+IQIHacMXu61pzehSo9p8oMgOoigIZqAbFV500wNgIZGAHU5Dlr0lypaYsnVk1bOkGn8r8zB9DA+BmzZsQBXV4/c+aMCqC6OiAG0jOqZ06flTx5XZch0MACoGGlQLwIaFgPENeDvBsJxCEzp83KmbyuM6b3WGVK+91Mh86r+QogH0xd2csElGcCGsY2Y8YMDiCbE8nLPF13chmABpkBsTUQMwMAyraFICNFV0sAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"redux-saga\"\n        title=\"\"\n        src=\"/static/f860bd1b76161ab4c3f39c95e4dd124e/fb8a0/redux-saga.png\"\n        srcset=\"/static/f860bd1b76161ab4c3f39c95e4dd124e/1a291/redux-saga.png 148w,\n/static/f860bd1b76161ab4c3f39c95e4dd124e/2bc4a/redux-saga.png 295w,\n/static/f860bd1b76161ab4c3f39c95e4dd124e/fb8a0/redux-saga.png 590w,\n/static/f860bd1b76161ab4c3f39c95e4dd124e/b4c1c/redux-saga.png 800w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p><code class=\"language-text\">redux-saga</code>는 앞서 설명한 <code class=\"language-text\">redux-thunk</code>와 같이 <code class=\"language-text\">redux</code>에서 비동기 데이터를 활용할 수 있도록 도와주는 라이브러리이다. <code class=\"language-text\">redux-thunk</code>와 다른 점은 <code class=\"language-text\">redux</code>를 통해 생성한 <code class=\"language-text\">action</code>의 <code class=\"language-text\">side effect</code>를 생성하는 별도의 <code class=\"language-text\">task</code>를 활용한다고 볼 수 있다. 해당 <code class=\"language-text\">task</code>를 통해 동기적인 <code class=\"language-text\">action</code>을 비동기적으로 호출해줄 수 있다.</p>\n<p><code class=\"language-text\">redux-thunk</code> 를 사용할때는 <code class=\"language-text\">action</code> 호출의 반환 상태를 객체 대신 함수로 변경한 뒤 비동기 요청 상태에 따라 다른 <code class=\"language-text\">action</code>을 호출해 주었다. 비동기 상태에 따라 <code class=\"language-text\">action</code> 을 호출하다 보면 결국 호출이 여러 단계로 중첩될 수 있으며, 이는 비동기 데이터 처리 로직이 복잡해질수록 중첩된 <code class=\"language-text\">action</code> 호출에 의한 전역 상태의 디버깅 및 테스트가 어려워지게 된다.</p>\n<p><code class=\"language-text\">redux-saga</code>는 동기적인 <code class=\"language-text\">action</code>의 <code class=\"language-text\">side effect</code>를 통해 액션 호출을 비동기적으로 제어할 수 있기 떼문에, <code class=\"language-text\">action</code> 자체가 가지고 있는 본연의 기능을 사용할 수 있으며 상태의 흐름 쉽게 파악할 수 있기 때문에 전역 상태를 관리하는 입장에서 <code class=\"language-text\">redux-thunk</code> 보다 장점을 가지고 있다.</p>\n<p>다만 비동기 액션 처리 시 <code class=\"language-text\">es6</code>의 <code class=\"language-text\">generator</code> 문법을 활용하며, <code class=\"language-text\">redux-saga</code>에서 제공하는 여러 기능의 사용법들은 사용자에 따라 높은 러닝커브를 요구하기도 한다. 나 역시 그 중 한명으로써 익숙하지 않은 <code class=\"language-text\">generator</code> 문법과 기본적인 활용법에 대해 아직 이해하지 못하는 부분이 많다.</p>\n<p>그래도 내가 이해하는 범위 내에서 <code class=\"language-text\">redux-saga</code>를 활용한 내용을 정리했다.</p>\n<h3>Client</h3>\n<p>우선 <code class=\"language-text\">redux-saga</code>를 설치하고 <code class=\"language-text\">action</code> 을 생성하는 부분을 수정한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">yarn add --dev redux-saga</code></pre></div>\n<ul>\n<li><code class=\"language-text\">src/redux/reducers/post.js</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> handleActions<span class=\"token punctuation\">,</span> createAction <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'redux-actions'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">GET_POST</span> <span class=\"token operator\">=</span> <span class=\"token string\">'GET_POST'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">GET_POST_SUCCESS</span> <span class=\"token operator\">=</span> <span class=\"token string\">'GET_POST_SUCCESS'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">GET_POST_ERROR</span> <span class=\"token operator\">=</span> <span class=\"token string\">'GET_POST_ERROR'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> getPost <span class=\"token operator\">=</span> <span class=\"token function\">createAction</span><span class=\"token punctuation\">(</span><span class=\"token constant\">GET_POST</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> getPostSuccess <span class=\"token operator\">=</span> <span class=\"token function\">createAction</span><span class=\"token punctuation\">(</span><span class=\"token constant\">GET_POST_SUCCESS</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> getPostError <span class=\"token operator\">=</span> <span class=\"token function\">createAction</span><span class=\"token punctuation\">(</span><span class=\"token constant\">GET_POST_ERROR</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> initialState <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  loading<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  error<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  data<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">handleActions</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">[</span><span class=\"token constant\">GET_POST</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        loading<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n        error<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n        data<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token constant\">GET_POST_SUCCESS</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">let</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> action<span class=\"token punctuation\">.</span>payload\n\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>Array<span class=\"token punctuation\">.</span><span class=\"token function\">isArray</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        data <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>data<span class=\"token punctuation\">]</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        loading<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n        error<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n        data<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token constant\">GET_POST_ERROR</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        loading<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n        error<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n        data<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  initialState\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// ...</span></code></pre></div>\n<p>이전에는 <code class=\"language-text\">GET_POST</code> 액션 요청에 따라 <code class=\"language-text\">GET_POST_LOADING</code>, <code class=\"language-text\">GET_POST_SUCCESS</code>, <code class=\"language-text\">GET_POST_ERROR</code> 라는 액션을 생성했다. 앞서 말했듯이 새롭게 생성된 액션은 <code class=\"language-text\">GET_POST</code>라는 액션 내부에 중첩된 액션이며 비동기 로직이 복잡해질 경우 해당 액션에 대한 테스트 및 디버깅이 어려워게 된다. 또한 액션 타입을 집적 설정하지 않기 때문에 코드 가독성도 떨어진다.</p>\n<p><code class=\"language-text\">redux-saga</code>의 경우 동기적인 액션을 활용하기 때문에 기본적으로 <code class=\"language-text\">redux</code>를 사용할때처럼 액션을 생성하도록 수정했다. <code class=\"language-text\">GET_POST</code> 액션 요청시 반환 상태에 따라  <code class=\"language-text\">GET_POST_SUCCESS</code>, <code class=\"language-text\">GET_POST_ERROR</code>라는 액션을 호출하도록 설정했다.</p>\n<p><code class=\"language-text\">redux-thunk</code>를 사용할때와 다른점은 현재 액션은 다른 액션에 종속되지 않는 각각의 독립된 액션이기 때문에 비동기 로직이 복잡해지더라도 테스트 및 디비겅에 보다 유리한 이점을 가지고 있다. 실제 비동기 로직이 복잡해질 경우 <code class=\"language-text\">redux-saga</code>를 통해 <code class=\"language-text\">task</code>를 수행하는 과정이 복잡해지겠지만, 기존에 <code class=\"language-text\">action</code> 내부에서 관리했던 역할을 분리할 수 있다는 것만으로드 큰 장점이 된다고 생각한다.</p>\n<p>이제 <code class=\"language-text\">GET_POST</code> 액션 호출 시 비동기적으로 <code class=\"language-text\">task</code>를 제어할 수 있도록 코드를 추가해 보자.</p>\n<ul>\n<li><code class=\"language-text\">src/redux/saga/post.js</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> call<span class=\"token punctuation\">,</span> put<span class=\"token punctuation\">,</span> take <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'redux-saga/effects'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> post <span class=\"token keyword\">from</span> <span class=\"token string\">'../reducers/post'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> loadData <span class=\"token keyword\">from</span> <span class=\"token string\">'../../lib/loadData'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span><span class=\"token operator\">*</span> <span class=\"token function\">getPost</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> payload <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">yield</span> <span class=\"token function\">take</span><span class=\"token punctuation\">(</span>post<span class=\"token punctuation\">.</span>getPost<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">yield</span> <span class=\"token function\">call</span><span class=\"token punctuation\">(</span>loadData<span class=\"token punctuation\">,</span> payload<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">yield</span> <span class=\"token function\">put</span><span class=\"token punctuation\">(</span>post<span class=\"token punctuation\">.</span><span class=\"token function\">getPostSuccess</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">yield</span> <span class=\"token function\">put</span><span class=\"token punctuation\">(</span>post<span class=\"token punctuation\">.</span><span class=\"token function\">getPostError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>앞서 설명했듯이 <code class=\"language-text\">redux-saga</code>는 <code class=\"language-text\">generator</code>를 활용하여  <code class=\"language-text\">effect</code></p>\n<h3>Server</h3>\n<h2>mobx-react</h2>\n<h3>Client</h3>\n<h3>Server</h3>\n<h2>다음 과제</h2>\n<p>지금까지 SPA 개발환경에서 비동기 데이터를 처리하는 방법에 대한 내용들을 정리했다. 다음은 <code class=\"language-text\">&lt;head/&gt;</code> 태그 내에서 사용되는 여러가지 요소를 관리해 줄 수 있는 라이브러리인 <code class=\"language-text\">react-helmet</code>를 SPA 환경에서 활용하는 방법에 대한 내용을 정리하고자 한다.</p>","frontmatter":{"title":"React를 활용한 isomorphic SPA 개발하기 - 5부","date":"2019.01.22","tags":["react"],"translation":null,"mainImage":{"childImageSharp":{"sizes":{"aspectRatio":1.6228209191759113,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEBf/EABQBAQAAAAAAAAAAAAAAAAAAAAL/2gAMAwEAAhADEAAAAaFRLKuMkY//xAAZEAADAQEBAAAAAAAAAAAAAAAAAQIREiL/2gAIAQEAAQUCxI80cyOmzR29/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQMBAT8BJ//EABYRAAMAAAAAAAAAAAAAAAAAAAIQIf/aAAgBAgEBPwEqv//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABsQAAICAwEAAAAAAAAAAAAAAAABITERQVHB/9oACAEBAAE/IWlIpNejzWXzG/RFpP/aAAwDAQACAAMAAAAQi8//xAAXEQEAAwAAAAAAAAAAAAAAAAABEBEh/9oACAEDAQE/EGGpcf/EABYRAQEBAAAAAAAAAAAAAAAAAAEREP/aAAgBAgEBPxChBmf/xAAaEAEBAQEAAwAAAAAAAAAAAAABEQAxQVGR/9oACAEBAAE/ELxAe8m4Jy54p91QWBzFkwoHB3//2Q==","sizes":"(max-width: 1024px) 100vw, 1024px","src":"/static/3975a2c64fe4b75af8dea6dd574cba1e/b16d8/react-redux-mobx.jpg","srcSet":"/static/3975a2c64fe4b75af8dea6dd574cba1e/01cea/react-redux-mobx.jpg 300w,\n/static/3975a2c64fe4b75af8dea6dd574cba1e/87418/react-redux-mobx.jpg 600w,\n/static/3975a2c64fe4b75af8dea6dd574cba1e/b16d8/react-redux-mobx.jpg 1024w"}}}}}},"pageContext":{"slug":"/development-isomorphic-spa-using-react-part5/","previous":{"id":"d6a109d5-cde5-53fc-826d-72b19ad2f5dd","excerpt":"\n> TypeScript를 활용한 사내 프로젝트의 리팩토링을 진행하면서 겪은 타입 에러의 종류과 그걸 해결하는 과정에 대한 내용으로 글을 정리했다. 생각보다 글 내용이 길어져 하나의 페이지에서 작성하려고 한 내용을 두개의 파트로 나누어셔 설명했기 때문에 기본적인 환경 설정 및 리팩토링 과정에서 특별히 배웠던 내용들은 이 전 글을 참고하면 된다.","frontmatter":{"title":"TypeScript를 활용한 JQuery 프로젝트 리팩토링 - 2부","date":"2019.01.14","tags":["javascript","typescript"],"translation":null,"mainImage":{"childImageSharp":{"sizes":{"aspectRatio":1.4377777777777778,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEAv/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAalq2TDQ/8QAGRAAAwEBAQAAAAAAAAAAAAAAAAECAyEi/9oACAEBAAEFApNPIljRhTurfVM0v//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAABEQL/2gAIAQEABj8CKsl1UyDpWj//xAAcEAEAAgIDAQAAAAAAAAAAAAABABExUSFBYYH/2gAIAQEAAT8hImo6HwLmGUdguVDw7iGYkMst9n//2gAMAwEAAgADAAAAEBPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHBABAAMAAgMAAAAAAAAAAAAAAQARITFBYXGh/9oACAEBAAE/EKTYAtXmvEZMpN2Rpz0wV8ltja+UMHaRfUbAs7Hc/9k=","sizes":"(max-width: 647px) 100vw, 647px","src":"/static/fa9faf67e355a83a127cbbf53e160fcb/65e46/refactoring.jpg","srcSet":"/static/fa9faf67e355a83a127cbbf53e160fcb/78ca6/refactoring.jpg 200w,\n/static/fa9faf67e355a83a127cbbf53e160fcb/924f1/refactoring.jpg 400w,\n/static/fa9faf67e355a83a127cbbf53e160fcb/65e46/refactoring.jpg 647w"}}}},"fields":{"slug":"/jquery-project-refactoring-using-typescript-part2/"}},"next":null}}